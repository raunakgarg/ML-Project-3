# -*- coding: utf-8 -*-
"""upgrad_case_study_stackoverflow.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1mY68_AR1PQr4C4c08u9YTEZb55qnlHCw
"""

import numpy as np
import pandas as pd

df_question = pd.read_csv('https://stack-overflow-casestudy-datasets.s3.amazonaws.com/Questions.csv', encoding='ISO-8859-1')

df_question.head(20)

df_question.drop_duplicates(inplace=True)

df_question["OwnerUserId"] = df_question["OwnerUserId"].fillna(0.0).astype(int)

df_question.count()

df_question.isna().sum()

df_question.info()

df_question['CreationDate'] = pd.to_datetime(df_question['CreationDate'])
df_question['ClosedDate'] = pd.to_datetime(df_question['ClosedDate'])

df_question.info()

df_question.head(10)

df_answer = pd.read_csv('https://stack-overflow-casestudy-datasets.s3.amazonaws.com/Answers.csv', encoding='ISO-8859-1')

df_answer.head(20)

df_answer.drop_duplicates(inplace=True)

df_answer.count()

df_answer['CreationDate'] = pd.to_datetime(df_answer['CreationDate'])

df_answer.isna().sum()

df_tags = pd.read_csv('https://stack-overflow-casestudy-datasets.s3.amazonaws.com/Tags.csv', encoding='ISO-8859-1')

df_tags.head(20)

df_tags.drop_duplicates(inplace=True)

df_tags.count()

df_tags.isna().sum()

df_user = pd.read_csv('https://stack-overflow-casestudy-datasets.s3.amazonaws.com/Users.csv', encoding='ISO-8859-1')

df_user.head(20)

df_user.drop('Unnamed: 0', axis=1, inplace=True)

df_user.drop_duplicates(inplace=True)

df_user['creation_date'] = pd.to_datetime(df_user['creation_date'])
df_user['last_access_date'] = pd.to_datetime(df_user['last_access_date'])

df_user.count()

df_user.isna().sum()

df_user.info()

df_question.info()

df_tags.info()

df_question_tags = pd.merge(df_question, df_tags, on=['Id'])

df_question_tags.head(20)

df_question_tags.info()

df_question_tags.Tag.value_counts()

df_question_tags.loc[df_question_tags['Tag'] == 'python']

df_question_tags_users = pd.merge(df_question_tags, df_user, on=[df_question_tags['OwnerUserId'] == df_user['id']])

